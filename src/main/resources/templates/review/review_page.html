<html layout:decorate="~{layout}" xmlns:th="http://www.thymeleaf.org">

<head>

<!-- moment.js Ìè¨Ìï® (ÌïÑÏàò) -->
<script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<!-- daterangepicker CSS Ìè¨Ìï® -->
<link rel="stylesheet"
   href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
<!-- daterangepicker JS Ìè¨Ìï® -->
<script
   src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<!-- Ïª§Ïä§ÌÖÄ CSS Ï∂îÍ∞Ä -->
<link rel="stylesheet" href="/css/review_page.css">
<link rel="stylesheet" href="/css/category.css">

   <!-- ÏßÄÎèÑ API Ìè¨Ìï® -->
   <script type="text/javascript"
      src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=4711bf21a08674cf6e20b64443d34887"></script>


<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />
</head>
<div layout:fragment="content">
    <!-- Í≤ÄÏÉâÎûÄ -->
   <div class="section1 container my-5">
      <div class="row d-flex justify-content-end">
         <!--ÏßÄÏó≠ÏÑ†ÌÉù-->
         <div class="col-auto">
            <select name="h_area1" id="region1" onChange="updateSubRegion()" class="h_area1 form-control">
               <option>-ÏßÄÏó≠ÏÑ†ÌÉù-</option>
               <option value="seoul">ÏÑúÏö∏</option>
               <option value="busan">Î∂ÄÏÇ∞</option>
               <option value="gyeonggi">Í≤ΩÍ∏∞ÎèÑ</option>
               <option value="daegu">ÎåÄÍµ¨</option>
               <!-- Í∏∞ÌÉÄ ÏßÄÏó≠Îì§ Ï∂îÍ∞Ä -->
            </select>
         </div>



<div class="col-auto">
    <select name="h_area2" id="region2" class="form-control">
        <option>-ÏÑ†ÌÉù-</option>
    </select>
</div>



         <!--Î©îÎâ¥ ÏÑ†ÌÉù-->
         <div class="col-auto">
            <button class="btn text-secondary bg-white  category_btn menu_btn">
               Î©îÎâ¥ <i class="fa-solid fa-utensils"></i>
            </button>
            <div class="card food_box">
               <div class="card-body m_card_body row justify-content-center ">
                  <button class="btn border btn-icon col-3">
                     <img src="/img/icon/bibimbap_8740490.png" alt="food_icon"
                        class="icon">
                     <div class="text">ÌïúÏãù</div>
                  </button>
                  <button class="btn border btn-icon col-3">
                     <img src="/img/icon/food_i_Chinese.png" alt="food_icon"
                        class="icon">
                     <div class="text">Ï§ëÏãù</div>
                  </button>
                  <button class="btn border btn-icon col-3">
                     <img src="/img/icon/food_i_japan.png" alt="food_icon"
                        class="icon">
                     <div class="text">ÏùºÏãù</div>
                  </button>
                  <button class="btn border btn-icon col-3">
                     <img src="/img/icon/food_i_Western.png" alt="food_icon"
                        class="icon">
                     <div class="text">ÏñëÏãù</div>
                  </button>
                  <button class="btn border btn-icon col-3 ">
                     <img src="/img/icon/food_i_fast.png" alt="food_icon" class="icon">
                     <div class="text ">Ìå®Ïä§Ìä∏Ìë∏Îìú</div>
                  </button>
                  <button class="btn border btn-icon col-3">
                     <img src="/img/icon/food_i_asian.png" alt="food_icon"
                        class="icon">
                     <div class="text">ÏïÑÏãúÏïà</div>
                  </button>
                  <button class="btn border btn-icon col-3">
                     <img src="/img/icon/food_i_omakase.png" alt="food_icon"
                        class="icon">
                     <div class="text">Ïò§ÎßàÏπ¥ÏÑ∏</div>
                  </button>
                  <button class="btn border btn-icon col-3">
                     <img src="/img/icon/food_i_dongne.png" alt="food_icon"
                        class="icon">
                     <div class="text">ÎèôÎÑ§ÎßõÏßë</div>
                  </button>
               </div>
            </div>
         </div>
         <!--Î©îÎâ¥ ÏÑ†ÌÉù ÎÅù-->


         <!-- ÏßÄÎèÑ ÏÑ†ÌÉù -->
         <div class="col-auto">
            <button class="btn text-secondary bg-white category_btn" onclick="showMap()">
               ÏßÄÎèÑ ÏÑ†ÌÉù<i class="fa-solid fa-map ml-1"></i>
            </button>
         </div>
     
  </div>
      <hr>
  <div id="map"></div>
   
   <button id="closeMap" onclick="closeMap()">ÏßÄÎèÑ Îã´Í∏∞</button>

    </div>
   <!-- section1 ÎÅù -->

   <!-- ÏßÄÎèÑ ÏöîÏÜå -->
 

   <!--Ï§ëÍ∞Ñ Í∏¥ Ï∫êÎ°úÏÖÄ-->
   <div class="section2 my-5">
      <div class="container my-5">
         <div id="carouselExampleFade" class="carousel slide my-5"
            data-ride="carousel">
            <ol class="carousel-indicators">
               <li data-target="#carouselExampleCaptions" data-slide-to="0"
                  class="active"></li>
               <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
            </ol>
            <div class="carousel-inner">
               <div class="carousel-item active">
                  <img src="/img/sub_carousel/carousel_1.png" class="d-block w-100"
                     alt="...">
               </div>
               <div class="carousel-item">
                  <img src="/img/sub_carousel/carousel_2.png" class="d-block w-100"
                     alt="...">
               </div>
            </div>
            <button class="carousel-control-prev" type="button"
               data-target="#carouselExampleFade" data-slide="prev">
               <span class="carousel-control-prev-icon" aria-hidden="true"></span>
               <span class="sr-only">Previous</span>
            </button>
            <button class="carousel-control-next" type="button"
               data-target="#carouselExampleFade" data-slide="next">
               <span class="carousel-control-next-icon" aria-hidden="true"></span>
               <span class="sr-only">Next</span>
            </button>
         </div>
      </div>
   </div>

   <!-- ÏàúÏÑúÌïÑÌÑ∞ -->
   <div class="container">
      <div class="row justify-content-between align-items-center">
         <div class="col-auto">
            <!-- Ï†ÑÏ≤¥ Î≤ÑÌäº -->
            <div class="dropdown">
               <button class="btn bg-white dropdown-toggle" type="button"
                  data-toggle="dropdown" aria-expanded="false">Ï†ÑÏ≤¥</button>
                     <div class="dropdown-menu">
            <a class="dropdown-item" href="/reviews/sorted?sort=all&direction=desc">Ï†ÑÏ≤¥</a>
            <a class="dropdown-item" href="/reviews/sorted?sort=date&direction=desc">ÏµúÏã† Ïàú</a>
            <a class="dropdown-item" href="/reviews/sorted?sort=date&direction=asc">Ïò§ÎûòÎêú Ïàú</a>
            <a class="dropdown-item" href="/reviews/sorted?sort=rating&direction=desc">Î≥ÑÏ†ê ÎßéÏùÄ Ïàú</a>
            <a class="dropdown-item" href="/reviews/sorted?sort=comments&direction=desc">ÎåìÍ∏Ä ÎßéÏùÄ Ïàú</a>
            <a class="dropdown-item" href="/reviews/sorted?sort=likes&direction=desc">Ï¢ãÏïÑÏöî Ïàú</a>
        </div>
            </div>
            <!--dropdown-->
         </div>
         <div class="col-auto d-flex align-items-center">
            <!-- Í≤ÄÏÉâÎûÄ -->
            <div class="d-flex align-items-center">
               <!-- ÎèôÍ∑∏ÎûÄ ÎÅùÎ∂ÄÎ∂ÑÏùÑ Í∞ÄÏßÑ Í≤ÄÏÉâÎ∞î -->
               <input type="text" class="form-control custom-search-bar"
                  placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
               <button class="btn btn-dark ml-2" style="width: 70px;">Í≤ÄÏÉâ</button>
               <!-- Í≤ÄÏÉâ Î≤ÑÌäº -->
            </div>
         </div>
      </div>
      <!--row-->
      <hr>
   </div>
   <!--ÏàúÏÑú container-->





   <!--card-->
   <div class="section3 mt-5">
      <div class="container my-5 ">
         <h3 class="mt-5">
            Ïù¥Î≤àÏ£º <span class="text-danger">üî•HOTÌïú</span> Î¶¨Î∑∞
         </h3>
         <div class="row S3_review_card">
         <!-- Î¶¨Î∑∞ Ïπ¥Îìú -->
            <div class="col-xl-4 col-lg-6 my-2" th:each="review : ${reviewPage}">
               <div class="card S3_card h-100 custom-border mx-auto">
                  <a th:href="@{/review_detail/{id}(id=${review.id})}"
                     class="text-dark">
                     <h5 class="d-flex align-items-center mt-3 ml-3 mb-2">
                        <!-- Î¶¨Î∑∞ ÏûëÏÑ±Ïûê ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ -->
                        <img
                           th:src="@{${review.user.imageUrl} != null ? ${review.user.imageUrl} : '/img/user/default-profile.png'}"
                           alt="user_img" class="rounded-circle"
                           style="width: 50px; height: 50px">
                        <!-- Î¶¨Î∑∞ ÏûëÏÑ±Ïûê ÏÇ¨Ïö©ÏûêÎ™Ö -->
                        <span class="d-flex align-items-center mx-2"
                           th:text="${review.user.nickname}"></span>
                     </h5>
                  </a>

                  <div th:id="'S3_review_carouselExample' + ${review.id}"
                     class="carousel slide carousel-fade px-2" data-ride="carousel">
                     <div class="carousel-inner S3_carousel-inner">
                        <a th:href="@{/review_detail/{id}(id=${review.id})}">
                           <div class="carousel-item S3_carousel-item"
                              th:each="imageMap, iterStat : ${review.reviewImageMap}"
                              th:classappend="${iterStat.index == 0} ? ' active'">
                              <img th:src="@{${imageMap.reviewImage.filepath}}"
                                 alt="Review detail Image"
                                 class="d-block w-100 S3_custom-card-img">
                           </div>
                        </a>
                     </div>
                     <!-- Ï∫êÎü¨ÏÖÄ Ï†úÏñ¥ Î≤ÑÌäº -->
                     <div class="d-block d-lg-none">
                        <a class="carousel-control-prev S3_hover_btn"
                           th:href="'#S3_review_carouselExample' + ${review.id}"
                           role="button" data-slide="prev"> <span
                           class="carousel-control-prev-icon" aria-hidden="true"></span> <span
                           class="sr-only">Previous</span>
                        </a> <a class="carousel-control-next S3_hover_btn"
                           th:href="'#S3_review_carouselExample' + ${review.id}"
                           role="button" data-slide="next"> <span
                           class="carousel-control-next-icon" aria-hidden="true"></span> <span
                           class="sr-only">Next</span>
                        </a>
                     </div>
                  </div>


                  <div class="card-body d-flex flex-column">
                     <div class="row p-3 S3_text-box ">
                        <!-- Î¶¨Î∑∞ Ï†úÎ™© -->
                        <div class="col-8 mx-0">
                           <a th:href="@{/review_detail/{id}(id=${review.id})}"
                              class="text-dark">
                              <h5 class="card-title S3_card-title" th:text="${review.title}"></h5>
                           </a>
                        </div>

                        <!-- ÎåìÍ∏ÄÍ≥º Ï¢ãÏïÑÏöîÍ∞Ä Ìïú Ï§ÑÏóê Î∞∞ÏπòÎêú Î∂ÄÎ∂Ñ -->
                        <div class="col-4 text-right d-flex justify-content-end"
                           style="margin-top: -35px;">
                           <!-- ÎåìÍ∏Ä -->
                           <div class="d-flex align-items-center ">
                              <img src="/img/icon/chat.png" alt="comment"
                                 style="width: 20px;" />  <span class="text-dark mx-1" style="margin-top: 2px;"
         th:text="${commentCountMap[review.id]}"></span>
                           </div>

                           <!-- Ï¢ãÏïÑÏöî -->
                           <div class="d-flex align-items-center like_box ml-1">
                              <!-- Î¶¨Î∑∞ IDÎ•º ÎèôÏ†ÅÏúºÎ°ú ÏÑ§Ï†ï -->
                              <input type="hidden" class="review-id" th:value="${review.id}">
                              <!-- likedByUser ÏÉÅÌÉúÎ•º ÎèôÏ†ÅÏúºÎ°ú ÏÑ§Ï†ï -->
                              <input type="hidden" class="liked-by-user"
                                 th:value="${likeStatusMap[review.id].liked}"> <i
                                 th:id="'like-btn-' + ${review.id}"
                                 class="tap_btn like_btn fa-regular fa-heart"></i> <span
                                 class="like-count ml-1"
                                 th:text="${likeStatusMap[review.id].likeCount}"></span>
                           </div>
                        </div>


                           <!-- ÏãùÎãπÏ†ïÎ≥¥ -->
                        <!-- ÏÑúÎ≤ÑÏóêÏÑú Î¶¨Î∑∞ Î¶¨Ïä§Ìä∏Î•º Î∞òÎ≥µÌï¥ÏÑú Ï∂úÎ†• -->
                        <p class="col-12 S3_store mb-1" th:each="review : ${reviews}">
                           <!-- Í∞Å Î¶¨Î∑∞Ïùò Í≥†Ïú† IDÎ•º data-review-idÏóê ÏÇΩÏûÖ -->
                        <div class="starRating" th:data-review-id="${review.id}"></div>
                        <a href="" style="text-decoration: none;"> <small
                           class="text-muted"> <i
                              class="fa-solid fa-location-dot mx-2" style="color: #000000;"></i>
                              <span class="font-weight-bold">ÏàòÏõêÏó≠ Í∑ºÏ≤ò</span> <span>ÎèºÏßÄÎÉ†ÎÉ†</span>
                        </small>
                        </a>
                        </p>

                        <!-- Î¶¨Î∑∞ÎÇ¥Ïö© -->
                        <p class="card-text S3_card-text mt-2 col-12 mb-2"
                           th:text="${review.content}"></p>


                        <!-- Î¶¨Î∑∞ÌÉúÍ∑∏ -->
                        <div class="mb-3 S3_tag_box ml-1">
                           <span th:each="tagMap : ${review.tagMaps}" calss="S3_tag_box">
                              <span class="badge badge-pill border border-dark"
                              th:text="'#'+${tagMap.reviewTag.name}"> </span>
                           </span>

                           <p class="card-text mt-2">
                              <small class="text-muted"> <span
                                 th:text="${#temporals.format(review.createDate, 'yyyy-MM-dd HH:mm')}"></span>
                                 ÏóÖÎç∞Ïù¥Ìä∏
                              </small>
                           </p>
                        </div>
                        <!--tag-->

                     </div>
                     <!--row-->

                  </div>
                  <!--card-body-->

               </div>
               <!--card-->

            </div>
            <!--col-lg-4-->

         </div>
         <!--row-->

      </div>
      <!--container-->


      <div class="container">
         <h3 class="mt-5 my-3">ÏÉàÎ°ú Ïò¨ÎùºÏò® ÌõÑÍ∏∞</h3>

      </div>
      <!--container-->
   </div>
   <!-- section -->


 <!-- ÏßÄÎèÑ Îç∞Ïù¥ÌÑ∞ ÌëúÏãú -->
   <div th:each="store : ${stores}">
       <input type="hidden" class="store-lat" th:value="${store.storeLatitude}" />
       <input type="hidden" class="store-lng" th:value="${store.storeLongitude}" />
       <input type="hidden" class="store-name" th:value="${store.storeName}" />
   </div>
   <script src="/js/review_page_like.js"></script>
  
<!-- ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ ÌååÏùº Ìè¨Ìï® (ÎùºÏù¥Î∏åÎü¨Î¶¨ Ïù¥ÌõÑÏóê Î°úÎìú) -->
<script src="js/review_page_category.js"></script>


</div>

</html>