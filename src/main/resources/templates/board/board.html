<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout}">

<head>
	<link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.min.css" rel="stylesheet">
	<script src="/webjars/jquery/jquery.min.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
	<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
	<link rel="stylesheet" href="/css/board/Board.css" />
</head>
	<div layout:fragment="content">
		<div class="container board" style="margin-top: 10px; margin-bottom: 80px;">
			<h5 class="my-4 border-bottom pb-3 display-4">게시글 목록</h5>
			<form id="searchForm" method="get" th:action="@{/board}">
				<input type="hidden" id="page" name="page" value="1">
				<div>
					<label>
						<input type="radio" name="searchType" value="title" th:checked="${searchType == 'title'}"> 제목
					</label>
					<span>&nbsp;</span>
					<label>
						<input type="radio" name="searchType" value="content" th:checked="${searchType == 'content'}">
						본문
					</label>
					<span>&nbsp;</span>
					<label>
						<input type="radio" name="searchType" value="username" th:checked="${searchType == 'username'}">
						글쓴이
					</label>
				</div>
				<span class="search_box mb-4 mt-3">
					<input type="text" id="search_kw" name="kw" placeholder="검색어 입력" th:value="${kw}" class="search_kw"
						style="flex: 1; margin-right: 5px;">
					<button type="submit" id="btn_search" class="search_btn"><i class="ri-search-line"></i></button>
				</span>
			</form>
			</form>
			<span class="">
				<a href="#" class="badge badge-dark board_tag" data-tag="">전체</a>
				<a href="#" class="badge badge-primary board_tag" data-tag="일반"><i class="ri-message-3-line"></i>일반</a>
				<a href="#" class="badge badge-secondary board_tag" data-tag="질문"> <i
						class="ri-question-mark"></i>질문</a>
				<a href="#" class="badge badge-success board_tag" data-tag="친구찾기"> <i
						class="ri-search-2-line"></i>친구찾기</a>
			
			</span>

			<table class="board_table" id="posts-table">
				<tr class="board_header ">
					<th class="board_num">번호</th>
					<th class="board_title">제목</th>
					<th>글쓴이</th>
					<th>작성일시</th>
					<th>댓글</th>
				</tr>
				<tbody class="board_body">
					<tr th:each="board, loop : ${board}" class="board_text">
						<td
							th:text="${boardPage.getTotalElements() - (boardPage.number * boardPage.size) - loop.index}">
						</td>
						<td>
							<a th:href="@{|/board_detail/${board.boardId}|}" class="text-dark boardLink"
								th:text="${board.boardTitle}">
						</td>
		
						<td>
							<span th:if="${board.username != null}" th:text="${board.username}"></span>

						</td>
						<td th:text="${#temporals.format(board.boardCreateDate, 'yyyy-MM-dd')}"></td>
						<td th:text="${board.answerList != null ? board.answerList.size() : 0}"></td>
						</a>
					</tr>

				</tbody>
			</table>

			<table class="table table-striped" id="posts-container">

			</table>
			<a class="float-right button button-primary" 
			   th:if="${userId != null}" 
			   th:href="@{/boardwrite/{id}(id=${userId})}">
			    <button type="button" class="btn btn-info text-white">게시글 작성</button>
			</a>
			<a class="float-right button button-primary" 
			   th:if="${userId == null}" 
			   th:href="@{/user/login}">
			    <button type="button" class="btn btn-info text-white">로그인 후 게시글 작성</button>
			</a>
				<nav th:if="${!board.isEmpty()}">
				    <ul class="pagination justify-content-center">
				        <li class="page-item" th:classappend="${!boardPage.hasPrevious()} ? 'disabled'">
				            <a th:href="@{/board(page=${boardPage.number-1}, kw=${kw})}" class="page-link" th:text="이전"></a>
				        </li>

				        <!-- 페이지 번호 표시 -->
				        <li th:each="page: ${#numbers.sequence(1, boardPage.totalPages)}"
				            th:if="${ 
				                (boardPage.totalPages <= 5) ||
				                (page >= (boardPage.number + 1) - 2 && page <= (boardPage.number + 1) + 2) ||
				                (page <= 5 && boardPage.number < 3) || 
				                (page >= boardPage.totalPages - 4 && boardPage.number > boardPage.totalPages - 3)
				            }"
				            th:classappend="${page == boardPage.number + 1} ? 'active'" class="page-item">
				            <a th:href="@{/board(page=${page - 1}, kw=${kw})}" class="page-link" th:text="${page}"></a>
				        </li>

				        <li class="page-item" th:classappend="${!boardPage.hasNext()} ? 'disabled'">
				            <a th:href="@{/board(page=${boardPage.number + 1}, kw=${kw})}" class="page-link" th:text="다음"></a>
				        </li>
				    </ul>
				</nav>
		</div>
		<script src="/js/board/board.js"></script>
	</div>
</html>